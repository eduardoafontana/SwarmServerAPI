using System;
using System.Collections.Generic;
using System.IO;
using System.IO.Compression;
using System.Net.Http;
using System.Net.Http.Headers;
using System.Text;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using SwarmServerAPI.AppCode.Repository;

namespace SwarmServerAPI.Tests.SwarmServerAPI.Tests.Controllers
{
    [TestClass]
    public class GZipTest
    {
        [TestMethod]
        public void GZipCompressTest()
        {
            byte[] buffer = Encoding.Unicode.GetBytes("Some data to be gzipped.");

            MemoryStream ms = new MemoryStream();
            using (GZipStream zip = new GZipStream(ms, CompressionMode.Compress, true))
            {
                zip.Write(buffer, 0, buffer.Length);
            }

            ms.Position = 0;

            byte[] compressedBuffer = new byte[ms.Length];
            ms.Read(compressedBuffer, 0, compressedBuffer.Length);

            byte[] gzBuffer = new byte[compressedBuffer.Length + 4];
            Buffer.BlockCopy(compressedBuffer, 0, gzBuffer, 4, compressedBuffer.Length);
            Buffer.BlockCopy(BitConverter.GetBytes(buffer.Length), 0, gzBuffer, 0, 4);

            string output = Convert.ToBase64String(gzBuffer);
        }

        [TestMethod]
        public void GZipUncompressTest()
        {
            byte[] gzBuffer = Convert.FromBase64String("MAAAAB+LCAAAAAAABAALZshnyGVIZVBgSGFIZCgBYgUgmQ8kk8Ci6QxVDJkMBUCYClShxwAA4OaqOjAAAAA=");

            using (MemoryStream ms = new MemoryStream())
            {
                int msgLength = BitConverter.ToInt32(gzBuffer, 0);
                ms.Write(gzBuffer, 4, gzBuffer.Length - 4);

                byte[] buffer = new byte[msgLength];

                ms.Position = 0;
                using (GZipStream zip = new GZipStream(ms, CompressionMode.Decompress))
                {
                    zip.Read(buffer, 0, buffer.Length);
                }

                string output = Encoding.Unicode.GetString(buffer, 0, buffer.Length);
            }
        }

        [TestMethod]
        public void String64Bits()
        {
            byte[] gzBuffer = Convert.FromBase64String("T2JqZWN0IHN1YmNsYXNzOiAjVW5kZWZpbmVkT2JqZWN0DQlpbnN0YW5jZVZhcmlhYmxlTmFtZXM6ICcnDQljbGFzc1ZhcmlhYmxlTmFtZXM6ICcnDQlwb29sRGljdGlvbmFyaWVzOiAnJw0JY2F0ZWdvcnk6ICdLZXJuZWwtT2JqZWN0cychDSFVbmRlZmluZWRPYmplY3QgY29tbWVudFN0YW1wOiAnJyBwcmlvcjogMCENSSBkZXNjcmliZSB0aGUgYmVoYXZpb3Igb2YgbXkgc29sZSBpbnN0YW5jZSwgbmlsLiBuaWwgcmVwcmVzZW50cyBhIHByaW9yIHZhbHVlIGZvciB2YXJpYWJsZXMgdGhhdCBoYXZlIG5vdCBiZWVuIGluaXRpYWxpemVkLCBvciBmb3IgcmVzdWx0cyB3aGljaCBhcmUgbWVhbmluZ2xlc3MuIQ0NDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJypSaW5nLURlcHJlY2F0ZWQtQ29yZS1LZXJuZWwnIHN0YW1wOiAnbmlsJyENYXNSaW5nRGVmaW5pdGlvbg0JDQleIHNlbGYhICENDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICd0ZXN0aW5nJyENaXNMaXRlcmFsDQleIHRydWUhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJ3Rlc3RpbmcnIQ1pc05pbCANCSJSZWZlciB0byB0aGUgY29tbWVudCBpbiBPYmplY3R8aXNOaWwuIg0NCV50cnVlISAhDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICd0ZXN0aW5nJyENaWZOaWw6IGFCbG9jaw0JIkEgY29udmVuaWVudCB0ZXN0LCBpbiBjb25qdW5jdGlvbiB3aXRoIE9iamVjdCBpZk5pbDoiDQ0JXiBhQmxvY2sgdmFsdWUhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJ3Rlc3RpbmcnIQ1oYWx0SWZOaWwNCTxkZWJ1Z2dlckNvbXBsZXRlVG9TZW5kZXI+DQlIYWx0IG5vdyEgIQ0NIVVuZGVmaW5lZE9iamVjdCBtZXRob2RzRm9yOiAndGVzdGluZychDWlzRW1wdHlPck5pbA0JIkFuc3dlciB3aGV0aGVyIHRoZSByZWNlaXZlciBjb250YWlucyBhbnkgZWxlbWVudHMsIG9yIGlzIG5pbC4gIFVzZWZ1bCBpbiBudW1lcm91cyBzaXR1YXRpb25zIHdoZXJlIG9uZSB3aXNoZXMgdGhlIHNhbWUgcmVhY3Rpb24gdG8gYW4gZW1wdHkgY29sbGVjdGlvbiBvciB0byBuaWwiDQleIHRydWUhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJ3Rlc3RpbmcnIQ1pZk5vdE5pbDogYUJsb2NrDQkiSWYgdGhlIHJlY2VpdmVyIGlzIG5vdCBuaWwsIHBhc3MgaXQgYXMgYXJndW1lbnQgdG8gdGhlIGJsb2NrLiINDQkiKDIgaWZOb3ROaWw6IFsgOm8gfCBvICsgM10pID4+PiA1Ig0JIihuaWwgaWZOb3ROaWw6IFs6byB8IG8gKzMgXSkgPj4+IG5pbCINDQleIHNlbGYhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJ3Rlc3RpbmcnIQ1ub3ROaWwgDQkiUmVmZXIgdG8gdGhlIGNvbW1lbnQgaW4gT2JqZWN0fG5vdE5pbC4iDQ0JXmZhbHNlISAhDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICd0ZXN0aW5nJyENaXNOb3ROaWwgDQkiUmVmZXIgdG8gdGhlIGNvbW1lbnQgaW4gT2JqZWN0fGlzTm90TmlsLiINDQleZmFsc2UhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJ3Rlc3RpbmcnIQ1pZk5vdE5pbDogaWZOb3ROaWxCbG9jayBpZk5pbDogbmlsQmxvY2sgDQkiSWYgdGhlIHJlY2VpdmVyIGlzIG5vdCBuaWwsIHBhc3MgaXQgYXMgYXJndW1lbnQgdG8gdGhlIGlmTm90TmlsQmxvY2sgYmxvY2suIGVsc2UgZXhlY3V0ZSB0aGUgbmlsQmxvY2sgYmxvY2sgIg0NCSIobmlsIGlmTm90TmlsOiBbOm8gfCBvICszIF0gaWZOaWw6IFs0Ml0pID4+PiA0MiINCSIoMyBpZk5vdE5pbDogWzpvIHwgbyArMyBdIGlmTmlsOiBbNDJdKSA+Pj4gNiINCQ0JXiBuaWxCbG9jayB2YWx1ZSEgIQ0NIVVuZGVmaW5lZE9iamVjdCBtZXRob2RzRm9yOiAndGVzdGluZychDWlmTmlsOiBuaWxCbG9jayBpZk5vdE5pbDogaWZOb3ROaWxCbG9jaw0JIklmIHRoZSByZWNlaXZlciBpcyBub3QgbmlsLCBwYXNzIGl0IGFzIGFyZ3VtZW50IHRvIHRoZSBpZk5vdE5pbEJsb2NrIGJsb2NrLiBlbHNlIGV4ZWN1dGUgdGhlIG5pbEJsb2NrIGJsb2NrICINDQkiKG5pbCBpZk5pbDogWzQyXSBpZk5vdE5pbDogWzpvIHwgbyArMyBdICkgPj4+IDQyIg0JIigzICBpZk5pbDogWzQyXSBpZk5vdE5pbDogWzpvIHwgbyArMyBdKSA+Pj4gNiINDQleIG5pbEJsb2NrIHZhbHVlISAhDQ0NIVVuZGVmaW5lZE9iamVjdCBtZXRob2RzRm9yOiAnY2xhc3MgaGllcmFyY2h5JyENY2xhc3NCdWlsZGVyDQkiQW5zd2VyIHRoZSBvYmplY3QgcmVzcG9uc2libGUgb2YgY3JlYXRpbmcgc3ViY2xhc3NlcyBvZiBteXNlbGYgaW4gdGhlIHN5c3RlbS4iDQkNCQleIHNlbGYgY2xhc3NJbnN0YWxsZXIgbmV3IGJ1aWxkZXIhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJ2NsYXNzIGhpZXJhcmNoeSchDXN1YmNsYXNzRGVmaW5lckNsYXNzDQkiRm9yIGRpc2p1bmN0IGNsYXNzIGhpZXJhcmNoaWVzIC0tIGhvdyBzaG91bGQgc3ViY2xhc3NlcyBvZiBuaWwgYmUgZXZhbHVhdGVkIg0JXnNlbGYgY2xhc3Mgc3ViY2xhc3NEZWZpbmVyQ2xhc3MhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJ2NsYXNzIGhpZXJhcmNoeSchDWxpdGVyYWxTY2FubmVkQXM6IHNjYW5uZWRMaXRlcmFsIG5vdGlmeWluZzogcmVxdWVzdG9yIA0JXiBzY2FubmVkTGl0ZXJhbCEgIQ0NIVVuZGVmaW5lZE9iamVjdCBtZXRob2RzRm9yOiAnY2xhc3MgaGllcmFyY2h5JyENZW52aXJvbm1lbnQNCSJOZWNlc3NhcnkgdG8gc3VwcG9ydCBkaXNqb2ludCBjbGFzcyBoaWVyYXJjaGllcy4iDQ0JXnNlbGYgY2xhc3MgZW52aXJvbm1lbnQhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJ2NsYXNzIGhpZXJhcmNoeSchDXJlbW92ZVN1YmNsYXNzOiBhQ2xhc3MNCSJJZ25vcmVkIC0tIG5lY2Vzc2FyeSB0byBzdXBwb3J0IGRpc2pvaW50IGNsYXNzIGhpZXJhcmNoaWVzIiEgIQ0NIVVuZGVmaW5lZE9iamVjdCBtZXRob2RzRm9yOiAnY2xhc3MgaGllcmFyY2h5JyENY2xhc3NJbnN0YWxsZXINCSJBbnN3ZXIgdGhlIGNsYXNzIHJlc3BvbnNpYmxlIG9mIGNyZWF0aW5nIGNsYXNzZXMgaW4gdGhlIHN5c3RlbS4iDQkNCV4gU21hbGx0YWxrIGNsYXNzSW5zdGFsbGVyICEgIQ0NIVVuZGVmaW5lZE9iamVjdCBtZXRob2RzRm9yOiAnY2xhc3MgaGllcmFyY2h5JyENYWRkU3ViY2xhc3M6IGFDbGFzcw0JIklnbm9yZWQgLS0gbmVjZXNzYXJ5IHRvIHN1cHBvcnQgZGlzam9pbnQgY2xhc3MgaGllcmFyY2hpZXMiISAhDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICdjbGFzcyBoaWVyYXJjaHknIQ10eXBlT2ZDbGFzcw0JIk5lY2Vzc2FyeSB0byBzdXBwb3J0IGRpc2pvaW50IGNsYXNzIGhpZXJhcmNoaWVzLiINCV4jbm9ybWFsISAhDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICdjbGFzcyBoaWVyYXJjaHknIQ1hbGxTdXBlcmNsYXNzZXNEbzogYUJsb2NrQ29udGV4dCANCSJJZ25vcmVkIC0tIG5lY2Vzc2FyeSB0byBzdXBwb3J0IGRpc2pvaW50IGNsYXNzIGhpZXJhcmNoaWVzIiEgIQ0NIVVuZGVmaW5lZE9iamVjdCBtZXRob2RzRm9yOiAnY2xhc3MgaGllcmFyY2h5JyENc3ViY2xhc3Nlcw0JIlJldHVybiBhbGwgdGhlIHN1YmNsYXNzZXMgb2YgbmlsIg0JfCBjbGFzc0xpc3QgfA0JY2xhc3NMaXN0IDo9IEFycmF5IG5ldyB3cml0ZVN0cmVhbS4NCXNlbGYgc3ViY2xhc3Nlc0RvOls6Y2xhc3N8IGNsYXNzTGlzdCBuZXh0UHV0OiBjbGFzc10uDQleY2xhc3NMaXN0IGNvbnRlbnRzISAhDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICdjbGFzcyBoaWVyYXJjaHknIQ1zdWJjbGFzczogbmFtZU9mQ2xhc3MgIA0JaW5zdGFuY2VWYXJpYWJsZU5hbWVzOiBpbnN0VmFyTmFtZXMNCWNsYXNzVmFyaWFibGVOYW1lczogY2xhc3NWYXJOYW1lcw0JcG9vbERpY3Rpb25hcmllczogcG9vbERpY3RuYW1lcw0JY2F0ZWdvcnk6IGNhdGVnb3J5DQkiQ2FsbGluZyB0aGlzIG1ldGhvZCBpcyBub3cgY29uc2lkZXJlZCBhbiBhY2NpZGVudC4gIElmIHlvdSByZWFsbHkgd2FudCB0byBjcmVhdGUgYSBjbGFzcyB3aXRoIGEgbmlsIHN1cGVyY2xhc3MsIHRoZW4gY3JlYXRlIHRoZSBjbGFzcyBhbmQgdGhlbiBzZXQgdGhlIHN1cGVyY2xhc3MgdXNpbmcgI3N1cGVyY2xhc3M6Ig0Jc2VsZiB0cmFjZUNyOiAoJ0F0dGVtcHQgdG8gY3JlYXRlICcsIG5hbWVPZkNsYXNzLCAnIGFzIGEgc3ViY2xhc3Mgb2YgbmlsLiAgUG9zc2libHkgYSBjbGFzcyBpcyBiZWluZyBsb2FkZWQgYmVmb3JlIGl0cyBzdXBlcmNsYXNzLicpLg0JXiBPYmplY3QNCQlzdWJjbGFzczogbmFtZU9mQ2xhc3MNCQlpbnN0YW5jZVZhcmlhYmxlTmFtZXM6IGluc3RWYXJOYW1lcw0JCWNsYXNzVmFyaWFibGVOYW1lczogY2xhc3NWYXJOYW1lcw0JCXBvb2xEaWN0aW9uYXJpZXM6IHBvb2xEaWN0bmFtZXMNCQljYXRlZ29yeTogY2F0ZWdvcnkNISAhDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICdjbGFzcyBoaWVyYXJjaHknIQ1zdWJjbGFzc2VzRG86IGFCbG9jaw0JIkV2YWx1YXRlIGFCbG9jayB3aXRoIGFsbCBzdWJjbGFzc2VzIG9mIG5pbC4gIE90aGVycyBhcmUgbm90IGRpcmVjdCBzdWJjbGFzc2VzIG9mIENsYXNzLiINDQleIENsYXNzIHN1YmNsYXNzZXNEbzogWzpjbCB8IA0JCQljbCBpc01ldGEgaWZUcnVlOiBbYUJsb2NrIHZhbHVlOiBjbCBzb2xlSW5zdGFuY2VdXS4hICENDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICcqVW5pZmllZEZGSSchDXBhY2tUb0FyaXR5OiBhTnVtYmVyDQkicG9pbnRlciB0byBOVUxMIGlzIE5VTEwgdG9vIg0JXiBzZWxmISAhDQ0NIVVuZGVmaW5lZE9iamVjdCBtZXRob2RzRm9yOiAnKkFsaWVuLUNvcmUnIQ1hc0FsaWVuDQleMCEgIQ0NDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJypvcGFsY29tcGlsZXItY29yZSchDWFsbFRlbXBOYW1lcw0JXiMoKSEgIQ0NDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJ2RlcGVuZGVudHMgYWNjZXNzJyENYWRkRGVwZW5kZW50OiBpZ25vcmVkIA0JIlJlZmVyIHRvIHRoZSBjb21tZW50IGluIE9iamVjdHxkZXBlbmRlbnRzLiINDQlzZWxmIGVycm9yOiAnTmlsIHNob3VsZCBub3QgaGF2ZSBkZXBlbmRlbnRzJyEgIQ0NDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJ3ByaW50aW5nJyENc3RvcmVPbjogYVN0cmVhbSANCSJSZWZlciB0byB0aGUgY29tbWVudCBpbiBPYmplY3R8c3RvcmVPbjouIiANDQlhU3RyZWFtIG5leHRQdXRBbGw6ICduaWwnISAhDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICdwcmludGluZychDXByaW50T246IGFTdHJlYW0gDQkiUmVmZXIgdG8gdGhlIGNvbW1lbnQgaW4gT2JqZWN0fHByaW50T246LiIgDQ0JYVN0cmVhbSBuZXh0UHV0QWxsOiAnbmlsJyEgIQ0NDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJ2JvdHRvbSBjb250ZXh0JyENaGFuZGxlU2lnbmFsOiBleGNlcHRpb24NCSJXaGVuIG5vIG1vcmUgaGFuZGxlciAob246ZG86KSBjb250ZXh0IGxlZnQgaW4gc2VuZGVyIGNoYWluIHRoaXMgZ2V0cyBjYWxsZWQuICBSZXR1cm4gZnJvbSBzaWduYWwgd2l0aCBkZWZhdWx0IGFjdGlvbi4iDQ0JXiBleGNlcHRpb24gcmVzdW1lVW5jaGVja2VkOiBleGNlcHRpb24gZGVmYXVsdEFjdGlvbiEgIQ0NIVVuZGVmaW5lZE9iamVjdCBtZXRob2RzRm9yOiAnYm90dG9tIGNvbnRleHQnIQ1jYW5IYW5kbGVTaWduYWw6IGV4Y2VwdGlvbg0JIldoZW4gbm8gbW9yZSBoYW5kbGVyIChvbjpkbzopIGNvbnRleHQgbGVmdCBpbiBzZW5kZXIgY2hhaW4gdGhpcyBnZXRzIGNhbGxlZCINDQleIGZhbHNlISAhDQ0NIVVuZGVmaW5lZE9iamVjdCBtZXRob2RzRm9yOiAnKm1ldGFjZWxsby1jb3JlJyENYXNNZXRhY2VsbG9WZXJzaW9uTnVtYmVyDQ0JXk1ldGFjZWxsb1ZlcnNpb25OdW1iZXIgZnJvbVN0cmluZzogJychICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJyptZXRhY2VsbG8tY29yZSchDXNldERlc2NyaXB0aW9uSW5NZXRhY2VsbG9WZXJzaW9uOiBhTWV0YWNlbGxvVmVyc2lvblNwZWMNDQlhTWV0YWNlbGxvVmVyc2lvblNwZWMgc2V0RGVzY3JpcHRpb246IHNlbGYhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJyptZXRhY2VsbG8tY29yZSchDXNldEJsZXNzaW5nSW5NZXRhY2VsbG9WZXJzaW9uOiBhTWV0YWNlbGxvVmVyc2lvblNwZWMNDQlhTWV0YWNlbGxvVmVyc2lvblNwZWMgc2V0Qmxlc3Npbmc6IHNlbGYhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJyptZXRhY2VsbG8tY29yZSchDW1ldGFjZWxsb1JlZ2lzdHJhdGlvbkhhc2gNICAgIF4gc2VsZiBoYXNoISAhDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICcqbWV0YWNlbGxvLWNvcmUnIQ1zZXRQcmVMb2FkRG9JdEluTWV0YWNlbGxvU3BlYzogYU1ldGFjZWxsb1NwZWMNDQlhTWV0YWNlbGxvU3BlYyBzZXRQcmVMb2FkRG9JdDogDQkJKGFNZXRhY2VsbG9TcGVjIHByb2plY3QgdmFsdWVIb2xkZXJTcGVjDQkJCXZhbHVlOiBzZWxmOw0JCQl5b3Vyc2VsZikhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJyptZXRhY2VsbG8tY29yZSchDXNldFBvc3RMb2FkRG9JdEluTWV0YWNlbGxvU3BlYzogYU1ldGFjZWxsb1NwZWMNDQlhTWV0YWNlbGxvU3BlYyBzZXRQb3N0TG9hZERvSXQ6IA0JCShhTWV0YWNlbGxvU3BlYyBwcm9qZWN0IHZhbHVlSG9sZGVyU3BlYw0JCQl2YWx1ZTogc2VsZjsNCQkJeW91cnNlbGYpISAhDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICcqbWV0YWNlbGxvLWNvcmUnIQ1zZXRQcm9qZWN0OiBhU3RyaW5nIHdpdGhJbk1ldGFjZWxsb0NvbmZpZzogYU1ldGFjZWxsb0NvbmZpZw0NCWFNZXRhY2VsbG9Db25maWcgc2V0UHJvamVjdDogYVN0cmluZyB3aXRoU3RyaW5nOiBzZWxmISAhDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICcqbWV0YWNlbGxvLWNvcmUnIQ1zZXRUaW1lc3RhbXBJbk1ldGFjZWxsb1ZlcnNpb246IGFNZXRhY2VsbG9WZXJzaW9uU3BlYw0NCWFNZXRhY2VsbG9WZXJzaW9uU3BlYyBzZXRUaW1lc3RhbXA6IHNlbGYhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJyptZXRhY2VsbG8tY29yZSchDWFzTWV0YWNlbGxvU2VtYW50aWNWZXJzaW9uTnVtYmVyDSAgICBeIE1ldGFjZWxsb1NlbWFudGljVmVyc2lvbk51bWJlciBmcm9tU3RyaW5nOiAnJyEgIQ0NIVVuZGVmaW5lZE9iamVjdCBtZXRob2RzRm9yOiAnKm1ldGFjZWxsby1jb3JlJyENc2V0QXV0aG9ySW5NZXRhY2VsbG9WZXJzaW9uOiBhTWV0YWNlbGxvVmVyc2lvblNwZWMNDQlhTWV0YWNlbGxvVmVyc2lvblNwZWMgc2V0QXV0aG9yOiBzZWxmISAhDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICcqbWV0YWNlbGxvLWNvcmUnIQ1yZWdpc3RyYXRpb25zQ29tcGFyZUVxdWFsOiBhTWV0YWNlbGxvUHJvamVjdFNwZWMNICAgIF4gc2VsZiA9IGFNZXRhY2VsbG9Qcm9qZWN0U3BlYyEgIQ0NDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJypGdWVsLUNvcmUnIQ1zZXJpYWxpemVPbjogYW5FbmNvZGVyDQkiRG8gbm90aGluZyIhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJypGdWVsLUNvcmUnIQ1mdWVsQWNjZXB0OiBhR2VuZXJhbE1hcHBlcg0NCV5hR2VuZXJhbE1hcHBlciB2aXNpdEhvb2tQcmltaXRpdmU6IHNlbGYhICENDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICdjb3B5aW5nJyENZGVlcENvcHkNCSJPbmx5IG9uZSBpbnN0YW5jZSBvZiBVbmRlZmluZWRPYmplY3Qgc2hvdWxkIGV2ZXIgYmUgbWFkZSwgc28gYW5zd2VyIA0Jd2l0aCBzZWxmLiIhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJ2NvcHlpbmcnIQ12ZXJ5RGVlcENvcHlXaXRoOiBkZWVwQ29waWVyDQkiUmV0dXJuIHNlbGYuICBJIGNhbid0IGJlIGNvcGllZC4gIERvIG5vdCByZWNvcmQgbWUuIiEgIQ0NIVVuZGVmaW5lZE9iamVjdCBtZXRob2RzRm9yOiAnY29weWluZychDXNoYWxsb3dDb3B5DQkiT25seSBvbmUgaW5zdGFuY2Ugb2YgVW5kZWZpbmVkT2JqZWN0IHNob3VsZCBldmVyIGJlIG1hZGUsIHNvIGFuc3dlciANCXdpdGggc2VsZi4iISAhDQ0NIVVuZGVmaW5lZE9iamVjdCBtZXRob2RzRm9yOiAnKkdsYW1vdXItTW9ycGhpYy1CcmljaychDXBobG93VmFsdWU6IGFuT2JqZWN0DQ0JXiBhbk9iamVjdCEgIQ0NIVVuZGVmaW5lZE9iamVjdCBtZXRob2RzRm9yOiAnKkdsYW1vdXItTW9ycGhpYy1CcmljaychDXBobG93VmFsdWU6IGFuT2JqZWN0IHZhbHVlOiBvdGhlck9iamVjdA0NCV4gYW5PYmplY3QhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJypHbGFtb3VyLU1vcnBoaWMtQnJpY2snIQ1icmlja1ZhbHVlOiBhbk9iamVjdCB3aXRoRW5vdWdoQXJndW1lbnRzOiBhQ29sbGVjdGlvbg0NCV4gYW5PYmplY3QhICENDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJypHbGFtb3VyLU1vcnBoaWMtQnJpY2snIQ1waGxvd1ZhbHVlOiBhbk9iamVjdCB3aXRoRW5vdWdoQXJndW1lbnRzOiBhQ29sbGVjdGlvbg0NCV4gYUNvbGxlY3Rpb24gZmlyc3QhICENDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICdzZXRzIHN1cHBvcnQnIQ1hc1NldEVsZW1lbnQNCSJTaW5jZSBuaWwgaXMgYSBzaW5nbGV0b24sIHdlIG5lZWQgb25seSBhIHNpbmdsZSB3cmFwcGVyIGluc3RhbmNlIHRvIHJlcHJlc2VudCBpdCBpbiBzZXQsDQljcmVhdGVkIGluIGFkdmFuY2UiDQleIFNldEVsZW1lbnQgd2l0aE5pbCEgIQ0NDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJypzdG9uLWNvcmUnIQ1zdG9uQ29udGFpblN1Yk9iamVjdHMgDQleIGZhbHNlISAhDQ0hVW5kZWZpbmVkT2JqZWN0IG1ldGhvZHNGb3I6ICcqc3Rvbi1jb3JlJyENc3Rvbk9uOiBzdG9uV3JpdGVyDQlzdG9uV3JpdGVyIHdyaXRlTnVsbCEgIQ0NDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJypHVC1JbnNwZWN0b3JFeHRlbnNpb25zLUNvcmUnIQ1ndEluc3BlY3RvclNvdXJjZUNvZGVJbjogY29tcG9zaXRlDQkiIG5vdGhpbmcgdG8gZG8gIiEgIQ0NDSFVbmRlZmluZWRPYmplY3QgbWV0aG9kc0ZvcjogJypuZW8tanNvbi1jb3JlJyBzdGFtcDogJ1N2ZW5WYW5DYWVrZW5iZXJnaGUgNi8yLzIwMTIgMjI6MTUnIQ1uZW9Kc29uT246IG5lb0pTT05Xcml0ZXINCW5lb0pTT05Xcml0ZXIgd3JpdGVOdWxsISAhDQ0iLS0gLS0gLS0gLS0gLS0gLS0gLS0gLS0gLS0gLS0gLS0gLS0gLS0gLS0gLS0gLS0gLS0gLS0gIiENDVVuZGVmaW5lZE9iamVjdCBjbGFzcw0JaW5zdGFuY2VWYXJpYWJsZU5hbWVzOiAnJyENDSFVbmRlZmluZWRPYmplY3QgY2xhc3MgbWV0aG9kc0ZvcjogJypGdWVsLUNvcmUnIQ1tYXRlcmlhbGl6ZUZyb206IGFEZWNvZGVyDQkiQW5zd2VyIG15IHVuaXF1ZSBpbnN0YW5jZSINDQleIG5pbCEgIQ0NDSFVbmRlZmluZWRPYmplY3QgY2xhc3MgbWV0aG9kc0ZvcjogJ2FjY2Vzc2luZychDWFsbEluc3RhbmNlcw0JIkl0IGlzIHdlbGwga25vd24gdGhlcmUgaXMgYSBzaW5nbGUgaW5zdGFuY2UiDQkNCV5BcnJheSB3aXRoOiBuaWwhICENDSFVbmRlZmluZWRPYmplY3QgY2xhc3MgbWV0aG9kc0ZvcjogJ2FjY2Vzc2luZychDWFsbEluc3RhbmNlc0RvOiBhQmxvY2sNCSJJdCBpcyB3ZWxsIGtub3duIHRoZXJlIGlzIGEgc2luZ2xlIGluc3RhbmNlIg0JDQlhQmxvY2sgdmFsdWU6IG5pbCEgIQ0NDSFVbmRlZmluZWRPYmplY3QgY2xhc3MgbWV0aG9kc0ZvcjogJ2luc3RhbmNlIGNyZWF0aW9uJyENbmV3DQlzZWxmIGVycm9yOiAnWW91IG1heSBub3QgY3JlYXRlIGFueSBtb3JlIHVuZGVmaW5lZCBvYmplY3RzLS11c2UgbmlsJyEgIQ0=");

            string outputDefault = Encoding.Default.GetString(gzBuffer);
            string outputUTF8 = Encoding.UTF8.GetString(gzBuffer);
            string outputUnicode = Encoding.Unicode.GetString(gzBuffer);

            string output = Convert.ToBase64String(gzBuffer);
        }

        [TestMethod]
        public void String64BitsOldDataString()
        {
            byte[] gzBuffer = Convert.FromBase64String("7A8AAB+LCAAAAAAABAC9V21vEkEQns8m/ofzPkFiUNoSTYskTYlNjVpiSfxQiIHjaKv0DrnDioT/7jOze7AH92qx2Sy3tzuvz+zMHHMK6I48uiGLrmiBt5BcuqcTek7PaJ5yWqMz8mmC4ZKDvTu8eTit0Tl2PMwZ9pxcKW3sD7DvgT8QOQ6eeVwXdJlL81H2f+bSdfH8jbd8ulv45MLakabgvQEofiRa/Bm0D+BWuPg0xrpGH2TtaXqeHmTcgzagKVYOVpZgq7gY31OcTKkO7l3ab7DGx8qkD4WCf1n+Un4tPaawcQgqxtnCnIgHAdYdeOfD8pnoMHniEpIlsdehRH289uJCsGWLxmKfmygnWXo0lFxGcy6es43MY8FSV6JmwfpotSokqy2jrJTVOmLZSJiYbvtv0fGecElCfz8oJUt+OszO9C12sOPvAanrdc6prPol+Ki7WsFzAVtcyc+KpnAkz5lil6O5Y1GLqhj9TBu4FnFGNhNi30q4J0Em0ha9w/SkvuTJrsC2k5KxYWkDXYsteO9jNcLqE3b5PlSEYqYr3TV8t3AywzqAtvIRile7Gn0V2Yy3quEuNNqovq70G184BlILR5gvcFY16mmalq6uih3x7Ra54oOfczJMPTFxTuOvFNL+CqMrtdXRfqkKrTol2zBJ0Md9aYPGLEMCI3SG6tLDuAI/x+MeGTuQWPKuj4wLJe9CyTuTu4Y167LpJTTb4FzsaCiGMvvZBv0Qem50Fzal8BfCKXAbSe5N/klm8v3w0Yft1NueJus9bOCufVsijpuMM/OgJVnAIy0/49SsT2W5LVwR9kOMaO1g2JKrxSwzNVixt6gGKttsZG1P6+1pbT2tm599zMdiMdSD9SVX4JpEItDfigO5lX/wdgmu7/q7spmqobVVhyIdRaMYxyrKiO0Kuo3bUvDZrde8ewxUlxpJsxOrM7VfpwM6pCNqxHBX3VXR8W8DdPxcCcUyU2ID0g4htZ4j8UhL7GMWjW52L7bkfjoam8fEOFsPRzovPkWj3tFVSMV0Gnszs9akS++hpmRTlqpxM/E80P08uSaYdFndurimTX2NtJkUFdyT1xgHusK0cascVE7+txMKlSt9oPoElrylN7iXyg6+AQ8ZVpSz5Fz449rK+/P/pZT5KvpC6r/npudlf9nF39TvX2YhqyHsDwAA");

            string outputDefault = Encoding.Default.GetString(gzBuffer);
            string outputUTF8 = Encoding.UTF8.GetString(gzBuffer);
            string outputUnicode = Encoding.Unicode.GetString(gzBuffer);

            string output = Convert.ToBase64String(gzBuffer);
        }
    }
}
